<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PCAPIFY - Network Anomaly Detection</title>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #0a0a0a;
    color: #fff;
    min-height: 100vh;
}

/* ===== Top Navbar ===== */
.navbar {
    height: 70px;
    background: linear-gradient(90deg, #000, #1a1a2e);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 30px;
    border-bottom: 2px solid #00e6ff;
    position: sticky;
    top: 0;
    z-index: 1000;
}

.navbar .logo {
    color: #00e6ff;
    font-size: 28px;
    font-weight: 800;
    letter-spacing: 1.5px;
    text-shadow: 0 0 10px rgba(0, 230, 255, 0.5);
}

.navbar .menu {
    display: flex;
    gap: 15px;
}

.navbar .menu a {
    color: #ccc;
    text-decoration: none;
    padding: 10px 20px;
    border-radius: 8px;
    transition: all 0.3s ease;
    font-weight: 600;
    border: 1px solid transparent;
}

.navbar .menu a:hover {
    background: rgba(0, 230, 255, 0.1);
    color: #00e6ff;
    border-color: #00e6ff;
    transform: translateY(-2px);
}

/* ===== Main Content ===== */
.main {
    padding: 30px;
    max-width: 1200px;
    margin: 0 auto;
}

/* ===== Cards ===== */
.card {
    background: rgba(20, 20, 30, 0.8);
    padding: 30px;
    border-radius: 15px;
    margin-bottom: 30px;
    border: 1px solid #333;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(10px);
    transition: transform 0.3s ease;
}

.card:hover {
    transform: translateY(-5px);
}

.card h2 {
    color: #00e6ff;
    margin-bottom: 20px;
    font-size: 28px;
    border-bottom: 2px solid #00e6ff;
    padding-bottom: 10px;
    display: inline-block;
}

/* ===== Inputs & Buttons ===== */
input, select {
    width: 100%;
    padding: 15px;
    margin: 15px 0;
    background: rgba(0, 0, 0, 0.5);
    color: #fff;
    border: 2px solid #444;
    border-radius: 10px;
    font-size: 16px;
    transition: all 0.3s ease;
}

input:focus, select:focus {
    outline: none;
    border-color: #00e6ff;
    box-shadow: 0 0 15px rgba(0, 230, 255, 0.3);
}

button {
    background: linear-gradient(45deg, #00e6ff, #0077ff);
    color: #000;
    border: none;
    padding: 15px 30px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 18px;
    font-weight: 700;
    transition: all 0.3s ease;
    margin-top: 10px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

button:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0, 230, 255, 0.3);
    background: linear-gradient(45deg, #00ffff, #0099ff);
}

button:active {
    transform: translateY(-1px);
}

button.secondary {
    background: linear-gradient(45deg, #666, #888);
}

button.secondary:hover {
    background: linear-gradient(45deg, #777, #999);
}

/* ===== File Upload ===== */
.file-upload-container {
    border: 3px dashed #00e6ff;
    border-radius: 15px;
    padding: 40px;
    text-align: center;
    margin: 20px 0;
    background: rgba(0, 230, 255, 0.05);
    cursor: pointer;
    transition: all 0.3s ease;
}

.file-upload-container:hover {
    background: rgba(0, 230, 255, 0.1);
    transform: scale(1.01);
}

.file-upload-container i {
    font-size: 48px;
    color: #00e6ff;
    margin-bottom: 20px;
}

/* ===== Messages ===== */
.message {
    padding: 15px;
    border-radius: 10px;
    margin: 15px 0;
    display: flex;
    align-items: center;
    gap: 10px;
    animation: slideIn 0.3s ease;
}

.message.error {
    background: rgba(255, 50, 50, 0.1);
    border-left: 4px solid #ff2b2b;
    color: #ff2b2b;
}

.message.success {
    background: rgba(0, 255, 100, 0.1);
    border-left: 4px solid #00ff88;
    color: #00ff88;
}

.message.info {
    background: rgba(0, 230, 255, 0.1);
    border-left: 4px solid #00e6ff;
    color: #00e6ff;
}

/* ===== Charts Container ===== */
.charts-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

.chart-wrapper {
    background: rgba(0, 0, 0, 0.5);
    border-radius: 15px;
    padding: 20px;
    border: 1px solid #333;
    transition: transform 0.3s ease;
}

.chart-wrapper:hover {
    transform: translateY(-5px);
    border-color: #00e6ff;
}

.chart-wrapper h3 {
    color: #00e6ff;
    margin-bottom: 15px;
    font-size: 18px;
    display: flex;
    align-items: center;
    gap: 10px;
}

canvas {
    width: 100% !important;
    height: 300px !important;
}

/* ===== Anomaly List ===== */
.anomaly-list {
    list-style: none;
    margin: 20px 0;
}

.anomaly-item {
    background: rgba(255, 50, 50, 0.1);
    padding: 15px;
    margin: 10px 0;
    border-radius: 10px;
    border-left: 4px solid #ff2b2b;
    display: flex;
    align-items: center;
    gap: 15px;
    animation: slideIn 0.3s ease;
    transition: all 0.3s ease;
}

.anomaly-item:hover {
    background: rgba(255, 50, 50, 0.2);
    transform: translateX(5px);
}

.anomaly-item.safe {
    background: rgba(0, 255, 100, 0.1);
    border-left: 4px solid #00ff88;
}

.anomaly-item.safe:hover {
    background: rgba(0, 255, 100, 0.2);
}

.anomaly-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.anomaly-icon.danger {
    background: #ff2b2b;
    color: white;
    box-shadow: 0 0 10px rgba(255, 43, 43, 0.5);
}

.anomaly-icon.safe {
    background: #00ff88;
    color: #000;
    box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
}

/* ===== Stats ===== */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.stat-card {
    background: rgba(0, 230, 255, 0.1);
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    border: 1px solid rgba(0, 230, 255, 0.3);
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-3px);
    border-color: #00e6ff;
    box-shadow: 0 5px 15px rgba(0, 230, 255, 0.2);
}

.stat-value {
    font-size: 36px;
    font-weight: 800;
    color: #00e6ff;
    margin-bottom: 5px;
    text-shadow: 0 0 10px rgba(0, 230, 255, 0.3);
}

.stat-label {
    font-size: 14px;
    color: #aaa;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* ===== Loading ===== */
.loading {
    display: inline-block;
    width: 30px;
    height: 30px;
    border: 3px solid rgba(0, 230, 255, 0.3);
    border-radius: 50%;
    border-top-color: #00e6ff;
    animation: spin 1s ease-in-out infinite;
}

.progress-bar {
    height: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
    overflow: hidden;
    margin: 20px 0;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #00e6ff, #0077ff);
    width: 0%;
    transition: width 0.3s ease;
    border-radius: 5px;
    position: relative;
    overflow: hidden;
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.4),
        transparent
    );
    animation: shimmer 2s infinite;
}

/* ===== Animations ===== */
@keyframes slideIn {
    from {
        transform: translateX(-20px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(0, 230, 255, 0.4);
    }
    70% {
        box-shadow: 0 0 0 10px rgba(0, 230, 255, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(0, 230, 255, 0);
    }
}

@keyframes shimmer {
    0% {
        transform: translateX(-100%);
    }
    100% {
        transform: translateX(100%);
    }
}

.pulse {
    animation: pulse 2s infinite;
}

/* ===== Utility Classes ===== */
.hidden {
    display: none !important;
}

.visible {
    display: block !important;
}

.flex {
    display: flex;
}

.flex-center {
    display: flex;
    align-items: center;
    justify-content: center;
}

.text-center {
    text-align: center;
}

.mt-20 {
    margin-top: 20px;
}

.mb-20 {
    margin-bottom: 20px;
}

/* ===== Responsive Design ===== */
@media (max-width: 768px) {
    .navbar {
        flex-direction: column;
        height: auto;
        padding: 15px;
    }
    
    .navbar .menu {
        flex-wrap: wrap;
        justify-content: center;
        margin-top: 15px;
    }
    
    .main {
        padding: 15px;
    }
    
    .card {
        padding: 20px;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .charts-container {
        grid-template-columns: 1fr;
    }
    
    .chart-wrapper {
        padding: 15px;
    }
    
    canvas {
        height: 250px !important;
    }
}
</style>

<!-- Font Awesome for Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

<!-- ===== Top Menu Bar ===== -->
<div class="navbar">
    <div class="logo">PCAPIFY</div>
    <div class="menu hidden" id="mainMenu">
        <a href="#" id="menuDashboard" onclick="showPage('dashboard')">
            <i class="fas fa-home"></i> Dashboard
        </a>
        <a href="#" id="menuUpload" onclick="showPage('uploadPage')">
            <i class="fas fa-upload"></i> Upload
        </a>
        <a href="#" id="menuResults" onclick="showPage('resultPage')">
            <i class="fas fa-chart-bar"></i> Results
        </a>
        <a href="#" id="menuAbout" onclick="showPage('about')">
            <i class="fas fa-info-circle"></i> About
        </a>
        <a href="#" id="menuLogout" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i> Logout
        </a>
    </div>
</div>

<div class="main">

<!-- Login Page -->
<div id="login" class="card">
    <h2><i class="fas fa-sign-in-alt"></i> Login to PCAPIFY</h2>
    <div class="message info">
        <i class="fas fa-info-circle"></i>
        <div>Use: admin / admin (Demo credentials)</div>
    </div>
    <input type="text" id="username" placeholder="Username" autocomplete="username">
    <input type="password" id="password" placeholder="Password" autocomplete="current-password">
    <button onclick="login()">
        <i class="fas fa-sign-in-alt"></i> Login
    </button>
    <div id="loginMessage" class="message error hidden"></div>
</div>

<!-- Dashboard -->
<div id="dashboard" class="card hidden">
    <h2><i class="fas fa-tachometer-alt"></i> System Overview</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value" id="loginCount">0</div>
            <div class="stat-label">Total Logins</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="analysisCount">0</div>
            <div class="stat-label">Analyses</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="anomalyCount">0</div>
            <div class="stat-label">Anomalies Found</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="accuracyRate">95%</div>
            <div class="stat-label">Accuracy</div>
        </div>
    </div>
    
    <!-- Dashboard Charts -->
    <div class="charts-container">
        <div class="chart-wrapper">
            <h3><i class="fas fa-chart-line"></i> Recent Activity</h3>
            <canvas id="dashboardLineChart"></canvas>
        </div>
        <div class="chart-wrapper">
            <h3><i class="fas fa-chart-pie"></i> Threat Distribution</h3>
            <canvas id="dashboardPieChart"></canvas>
        </div>
    </div>
    
    <p class="mt-20">
        <i class="fas fa-shield-alt"></i> <b>PCAPIFY</b> analyzes <b>PCAP (Packet Capture)</b> files using 
        machine learning algorithms to identify anomalous or suspicious network traffic patterns.
    </p>
    <ul class="mt-20">
        <li><i class="fas fa-check-circle" style="color:#00ff88"></i> Abnormal traffic detection</li>
        <li><i class="fas fa-check-circle" style="color:#00ff88"></i> Intrusion attempt identification</li>
        <li><i class="fas fa-check-circle" style="color:#00ff88"></i> Network security visibility</li>
        <li><i class="fas fa-check-circle" style="color:#00ff88"></i> Real-time analysis</li>
        <li><i class="fas fa-check-circle" style="color:#00ff88"></i> Detailed reporting</li>
    </ul>
    
    <div class="mt-20">
        <button onclick="showPage('uploadPage')">
            <i class="fas fa-play"></i> Start Analysis
        </button>
        <button class="secondary" onclick="showPage('about')">
            <i class="fas fa-book"></i> Documentation
        </button>
    </div>
</div>

<!-- Upload Page -->
<div id="uploadPage" class="card hidden">
    <h2><i class="fas fa-cloud-upload-alt"></i> Upload PCAP File</h2>
    
    <div class="file-upload-container" onclick="document.getElementById('pcapFile').click()" id="dropZone">
        <i class="fas fa-file-archive pulse"></i>
        <h3>Drag & Drop PCAP File Here</h3>
        <p>or click to browse (Supports .pcap, .pcapng)</p>
        <p style="color:#aaa; font-size:14px;">Maximum file size: 100MB</p>
    </div>
    
    <input type="file" id="pcapFile" accept=".pcap,.pcapng" class="hidden">
    
    <div id="fileInfo" class="message info hidden">
        <i class="fas fa-file"></i>
        <div>
            <div id="fileName"></div>
            <div id="fileSize" style="font-size:12px;"></div>
        </div>
    </div>
    
    <div class="flex" style="gap:15px; margin-top:20px;">
        <div style="flex:2;">
            <label>Detection Sensitivity</label>
            <select id="sensitivity">
                <option value="low">Low (Fewer false positives)</option>
                <option value="medium" selected>Medium (Balanced)</option>
                <option value="high">High (More aggressive)</option>
            </select>
        </div>
        <div style="flex:1;">
            <label>Analysis Type</label>
            <select id="analysisType">
                <option value="basic">Basic Analysis</option>
                <option value="advanced">Advanced ML</option>
                <option value="deep">Deep Packet</option>
            </select>
        </div>
    </div>
    
    <div class="progress-bar hidden" id="progressBar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    
    <div id="uploadMessage" class="message hidden"></div>
    
    <button onclick="analyzeFile()" id="analyzeBtn">
        <i class="fas fa-search"></i> Analyze for Anomalies
    </button>
    
    <button class="secondary" onclick="showPage('dashboard')">
        <i class="fas fa-arrow-left"></i> Back to Dashboard
    </button>
</div>

<!-- Results Page -->
<div id="resultPage" class="card hidden">
    <h2><i class="fas fa-chart-line"></i> Analysis Results</h2>
    
    <div class="message info">
        <i class="fas fa-file-alt"></i>
        <div>
            <strong>File:</strong> <span id="resultFileName">No file analyzed</span><br>
            <small id="resultTimestamp"></small>
        </div>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value" id="totalPackets">0</div>
            <div class="stat-label">Total Packets</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="detectedAnomalies">0</div>
            <div class="stat-label">Anomalies</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="riskScore">0%</div>
            <div class="stat-label">Risk Score</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="analysisTime">0s</div>
            <div class="stat-label">Analysis Time</div>
        </div>
    </div>
    
    <h3><i class="fas fa-exclamation-triangle"></i> Detected Anomalies</h3>
    <div id="anomalyList" class="anomaly-list">
        <!-- Anomalies will be added here dynamically -->
    </div>
    
    <!-- Results Charts Container -->
    <div class="charts-container">
        <div class="chart-wrapper">
            <h3><i class="fas fa-chart-line"></i> Anomaly Score Timeline</h3>
            <canvas id="lineGraph"></canvas>
        </div>
        
        <div class="chart-wrapper">
            <h3><i class="fas fa-chart-pie"></i> Anomaly Distribution</h3>
            <canvas id="pieChart"></canvas>
        </div>
        
        <div class="chart-wrapper">
            <h3><i class="fas fa-chart-bar"></i> Severity Levels</h3>
            <canvas id="barChart"></canvas>
        </div>
        
        <div class="chart-wrapper">
            <h3><i class="fas fa-chart-area"></i> Protocol Distribution</h3>
            <canvas id="radarChart"></canvas>
        </div>
    </div>
    
    <div class="flex" style="gap:15px; margin-top:20px;">
        <button onclick="exportResults()">
            <i class="fas fa-download"></i> Export Report
        </button>
        <button onclick="showPage('uploadPage')">
            <i class="fas fa-redo"></i> Analyze Another
        </button>
        <button class="secondary" onclick="showPage('dashboard')">
            <i class="fas fa-home"></i> Dashboard
        </button>
    </div>
</div>

<!-- About Page -->
<div id="about" class="card hidden">
    <h2><i class="fas fa-info-circle"></i> About PCAPIFY</h2>
    
    <div class="message info">
        <i class="fas fa-shield-alt"></i>
        <div>Advanced Network Security Analysis Platform</div>
    </div>
    
    <p>
        PCAPIFY is a cutting-edge cybersecurity tool designed for detecting suspicious
        patterns and anomalies in network packet captures. Using machine learning algorithms,
        it identifies potential security threats in real-time.
    </p>
    
    <h3>Key Features:</h3>
    <ul>
        <li><i class="fas fa-bolt" style="color:#00e6ff"></i> Real-time Intrusion Detection</li>
        <li><i class="fas fa-brain" style="color:#00e6ff"></i> Machine Learning Analysis</li>
        <li><i class="fas fa-chart-bar" style="color:#00e6ff"></i> Visual Analytics Dashboard</li>
        <li><i class="fas fa-history" style="color:#00e6ff"></i> Historical Data Tracking</li>
        <li><i class="fas fa-file-export" style="color:#00e6ff"></i> Comprehensive Reporting</li>
    </ul>
    
    <div class="charts-container" style="margin: 30px 0;">
        <div class="chart-wrapper">
            <h3><i class="fas fa-trend-up"></i> Performance Metrics</h3>
            <canvas id="aboutLineChart"></canvas>
        </div>
        
        <div class="chart-wrapper">
            <h3><i class="fas fa-project-diagram"></i> Detection Accuracy</h3>
            <canvas id="aboutPieChart"></canvas>
        </div>
    </div>
    
    <h3>Use Cases:</h3>
    <ul>
        <li>Security Operations Center (SOC) Monitoring</li>
        <li>Network Forensics Investigations</li>
        <li>Incident Response Analysis</li>
        <li>Security Compliance Auditing</li>
        <li>Network Performance Monitoring</li>
    </ul>
    
    <div class="mt-20">
        <button onclick="showPage('dashboard')">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </button>
    </div>
</div>

</div>

<script>
// Application State
let currentUser = null;
let analysisHistory = JSON.parse(localStorage.getItem('pcapify_analysis_history') || '[]');
let loginHistory = JSON.parse(localStorage.getItem('pcapify_login_history') || '[]');
let lineChart = null;
let pieChart = null;
let barChart = null;
let radarChart = null;
let dashboardLineChart = null;
let dashboardPieChart = null;
let aboutLineChart = null;
let aboutPieChart = null;

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    // Check for existing session
    const savedUser = localStorage.getItem('pcapify_current_user');
    if (savedUser) {
        currentUser = JSON.parse(savedUser);
        showAuthenticatedUI();
    }
    
    // Setup drag and drop
    setupDragAndDrop();
    
    // Update dashboard stats
    updateDashboardStats();
    
    // Draw initial charts
    drawDashboardCharts();
});

// Setup drag and drop functionality
function setupDragAndDrop() {
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('pcapFile');
    
    // Prevent default drag behaviors
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, preventDefaults, false);
        document.body.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    // Highlight drop zone
    ['dragenter', 'dragover'].forEach(eventName => {
        dropZone.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight() {
        dropZone.style.borderColor = '#00e6ff';
        dropZone.style.background = 'rgba(0, 230, 255, 0.15)';
    }
    
    function unhighlight() {
        dropZone.style.borderColor = '#00e6ff';
        dropZone.style.background = 'rgba(0, 230, 255, 0.05)';
    }
    
    // Handle dropped files
    dropZone.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        handleFileSelection(files[0]);
    }
    
    // Handle file input change
    fileInput.addEventListener('change', function(e) {
        if (this.files.length > 0) {
            handleFileSelection(this.files[0]);
        }
    });
}

// Handle file selection
function handleFileSelection(file) {
    if (!file) return;
    
    // Validate file type
    const validExtensions = ['.pcap', '.pcapng'];
    const fileExt = '.' + file.name.split('.').pop().toLowerCase();
    
    if (!validExtensions.includes(fileExt)) {
        showMessage('uploadMessage', 'Please select a valid PCAP file (.pcap or .pcapng)', 'error');
        return;
    }
    
    // Validate file size (100MB limit)
    const maxSize = 100 * 1024 * 1024; // 100MB in bytes
    if (file.size > maxSize) {
        showMessage('uploadMessage', 'File size exceeds 100MB limit', 'error');
        return;
    }
    
    // Show file info
    document.getElementById('fileName').textContent = file.name;
    document.getElementById('fileSize').textContent = formatFileSize(file.size);
    document.getElementById('fileInfo').classList.remove('hidden');
    
    showMessage('uploadMessage', `File "${file.name}" ready for analysis`, 'success');
    
    // Store file for later use
    window.currentFile = file;
}

// Format file size
function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

// Login function
function login() {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();
    
    if (!username || !password) {
        showMessage('loginMessage', 'Please enter both username and password', 'error');
        return;
    }
    
    // Demo authentication - In production, this would call an API
    if (username === 'admin' && password === 'admin') {
        currentUser = {
            username: username,
            role: 'admin',
            loginTime: new Date().toISOString()
        };
        
        // Save user session
        localStorage.setItem('pcapify_current_user', JSON.stringify(currentUser));
        
        // Log login
        loginHistory.push({
            username: username,
            timestamp: new Date().toISOString(),
            ip: '127.0.0.1' // Demo IP
        });
        localStorage.setItem('pcapify_login_history', JSON.stringify(loginHistory));
        
        showMessage('loginMessage', 'Login successful!', 'success');
        
        // Update UI
        setTimeout(() => {
            showAuthenticatedUI();
            updateDashboardStats();
            drawDashboardCharts();
        }, 500);
    } else {
        showMessage('loginMessage', 'Invalid credentials. Use admin/admin', 'error');
    }
}

// Show authenticated UI
function showAuthenticatedUI() {
    document.getElementById('mainMenu').classList.remove('hidden');
    document.getElementById('login').classList.add('hidden');
    showPage('dashboard');
    
    // Clear login form
    document.getElementById('username').value = '';
    document.getElementById('password').value = '';
    document.getElementById('loginMessage').classList.add('hidden');
}

// Logout function
function logout() {
    currentUser = null;
    localStorage.removeItem('pcapify_current_user');
    document.getElementById('mainMenu').classList.add('hidden');
    showPage('login');
}

// Page navigation
function showPage(pageId) {
    // Hide all pages
    const pages = ['login', 'dashboard', 'uploadPage', 'resultPage', 'about'];
    pages.forEach(id => {
        document.getElementById(id).classList.add('hidden');
    });
    
    // Show requested page
    document.getElementById(pageId).classList.remove('hidden');
    
    // Update active menu item
    document.querySelectorAll('.navbar .menu a').forEach(link => {
        link.classList.remove('active');
    });
    
    const activeLink = document.querySelector(`[onclick="showPage('${pageId}')"]`);
    if (activeLink) {
        activeLink.classList.add('active');
    }
    
    // Draw charts for specific pages
    if (pageId === 'dashboard') {
        drawDashboardCharts();
    } else if (pageId === 'about') {
        drawAboutCharts();
    }
}

// Update dashboard statistics
function updateDashboardStats() {
    const loginCount = loginHistory.length;
    const analysisCount = analysisHistory.length;
    const totalAnomalies = analysisHistory.reduce((sum, analysis) => sum + (analysis.anomalies || 0), 0);
    
    document.getElementById('loginCount').textContent = loginCount;
    document.getElementById('analysisCount').textContent = analysisCount;
    document.getElementById('anomalyCount').textContent = totalAnomalies;
}

// Draw dashboard charts
function drawDashboardCharts() {
    // Destroy existing charts
    if (dashboardLineChart) dashboardLineChart.destroy();
    if (dashboardPieChart) dashboardPieChart.destroy();
    
    // Line Chart for Recent Activity
    const lineCtx = document.getElementById('dashboardLineChart').getContext('2d');
    dashboardLineChart = new Chart(lineCtx, {
        type: 'line',
        data: {
            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
            datasets: [{
                label: 'Analyses',
                data: [12, 19, 8, 15, 22, 10, 18],
                borderColor: '#00e6ff',
                backgroundColor: 'rgba(0, 230, 255, 0.1)',
                fill: true,
                tension: 0.4
            }, {
                label: 'Anomalies',
                data: [3, 7, 2, 5, 9, 4, 6],
                borderColor: '#ff2b2b',
                backgroundColor: 'rgba(255, 43, 43, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: getChartOptions('Weekly Activity Trends')
    });
    
    // Pie Chart for Threat Distribution
    const pieCtx = document.getElementById('dashboardPieChart').getContext('2d');
    dashboardPieChart = new Chart(pieCtx, {
        type: 'pie',
        data: {
            labels: ['Port Scans', 'DDoS', 'Malware', 'Data Exfil', 'Other'],
            datasets: [{
                data: [35, 25, 20, 15, 5],
                backgroundColor: [
                    '#00e6ff',
                    '#ff2b2b',
                    '#ff9500',
                    '#00ff88',
                    '#9d4edd'
                ],
                borderColor: '#fff',
                borderWidth: 2
            }]
        },
        options: getChartOptions('Threat Distribution')
    });
}

// Draw about page charts
function drawAboutCharts() {
    if (aboutLineChart) aboutLineChart.destroy();
    if (aboutPieChart) aboutPieChart.destroy();
    
    // Performance Metrics Chart
    const aboutLineCtx = document.getElementById('aboutLineChart').getContext('2d');
    aboutLineChart = new Chart(aboutLineCtx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                label: 'Detection Rate (%)',
                data: [85, 88, 92, 90, 94, 95],
                borderColor: '#00e6ff',
                backgroundColor: 'rgba(0, 230, 255, 0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: getChartOptions('Monthly Performance')
    });
    
    // Detection Accuracy Chart
    const aboutPieCtx = document.getElementById('aboutPieChart').getContext('2d');
    aboutPieChart = new Chart(aboutPieCtx, {
        type: 'doughnut',
        data: {
            labels: ['True Positive', 'False Positive', 'True Negative', 'False Negative'],
            datasets: [{
                data: [85, 8, 92, 3],
                backgroundColor: [
                    '#00ff88',
                    '#ff2b2b',
                    '#00e6ff',
                    '#ff9500'
                ],
                borderColor: '#fff',
                borderWidth: 2
            }]
        },
        options: getChartOptions('Detection Accuracy')
    });
}

// Get common chart options
function getChartOptions(title) {
    return {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: {
                labels: {
                    color: '#fff',
                    font: {
                        size: 12
                    }
                }
            },
            title: {
                display: true,
                text: title,
                color: '#00e6ff',
                font: {
                    size: 16,
                    weight: 'bold'
                }
            },
            tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                titleColor: '#00e6ff',
                bodyColor: '#fff',
                borderColor: '#00e6ff',
                borderWidth: 1
            }
        },
        scales: {
            x: {
                ticks: {
                    color: '#aaa'
                },
                grid: {
                    color: 'rgba(255, 255, 255, 0.1)'
                }
            },
            y: {
                ticks: {
                    color: '#aaa'
                },
                grid: {
                    color: 'rgba(255, 255, 255, 0.1)'
                }
            }
        }
    };
}

// Analyze file
async function analyzeFile() {
    if (!window.currentFile) {
        showMessage('uploadMessage', 'Please select a file first', 'error');
        return;
    }
    
    const analyzeBtn = document.getElementById('analyzeBtn');
    const progressBar = document.getElementById('progressBar');
    const progressFill = document.getElementById('progressFill');
    
    // Show progress bar
    progressBar.classList.remove('hidden');
    progressFill.style.width = '0%';
    
    // Disable button and show loading
    analyzeBtn.disabled = true;
    analyzeBtn.innerHTML = '<div class="loading"></div> Analyzing...';
    
    // Simulate analysis progress
    let progress = 0;
    const progressInterval = setInterval(() => {
        progress += Math.random() * 20;
        if (progress > 100) progress = 100;
        progressFill.style.width = progress + '%';
        
        if (progress >= 100) {
            clearInterval(progressInterval);
            simulateAnalysisResults();
        }
    }, 300);
}

// Simulate analysis results (for demo)
function simulateAnalysisResults() {
    // Generate mock analysis data
    const startTime = Date.now();
    const fileName = window.currentFile.name;
    
    // Generate random anomaly scores
    const scores = Array.from({length: 20}, () => Math.random() * 10);
    const anomalies = scores.filter(score => score > 6).length;
    const totalPackets = Math.floor(Math.random() * 5000) + 1000;
    const riskScore = Math.round((anomalies / 20) * 100);
    const analysisTime = ((Date.now() - startTime) / 1000).toFixed(2);
    
    // Create analysis record
    const analysisRecord = {
        filename: fileName,
        timestamp: new Date().toISOString(),
        anomalies: anomalies,
        totalPackets: totalPackets,
        riskScore: riskScore,
        analysisTime: analysisTime,
        scores: scores
    };
    
    // Save to history
    analysisHistory.push(analysisRecord);
    localStorage.setItem('pcapify_analysis_history', JSON.stringify(analysisHistory));
    
    // Update UI
    updateResultsPage(analysisRecord);
    
    // Reset upload button
    const analyzeBtn = document.getElementById('analyzeBtn');
    const progressBar = document.getElementById('progressBar');
    
    analyzeBtn.disabled = false;
    analyzeBtn.innerHTML = '<i class="fas fa-search"></i> Analyze for Anomalies';
    progressBar.classList.add('hidden');
    
    // Show success message
    showMessage('uploadMessage', `Analysis complete! Found ${anomalies} anomalies`, 'success');
    
    // Navigate to results
    setTimeout(() => {
        showPage('resultPage');
    }, 500);
}

// Update results page with analysis data
function updateResultsPage(data) {
    document.getElementById('resultFileName').textContent = data.filename;
    document.getElementById('resultTimestamp').textContent = new Date(data.timestamp).toLocaleString();
    document.getElementById('totalPackets').textContent = data.totalPackets.toLocaleString();
    document.getElementById('detectedAnomalies').textContent = data.anomalies;
    document.getElementById('riskScore').textContent = data.riskScore + '%';
    document.getElementById('analysisTime').textContent = data.analysisTime + 's';
    
    // Update anomaly list
    const anomalyList = document.getElementById('anomalyList');
    anomalyList.innerHTML = '';
    
    if (data.anomalies === 0) {
        const item = document.createElement('div');
        item.className = 'anomaly-item safe';
        item.innerHTML = `
            <div class="anomaly-icon safe">
                <i class="fas fa-check"></i>
            </div>
            <div>
                <strong>No anomalies detected</strong>
                <div style="font-size: 12px; color: #aaa;">All traffic appears normal</div>
            </div>
        `;
        anomalyList.appendChild(item);
    } else {
        const anomalyTypes = [
            'Port Scanning Activity',
            'DDoS Attack Pattern',
            'Malformed Packets',
            'Protocol Violation',
            'Suspicious Payload',
            'Brute Force Attempt',
            'Data Exfiltration',
            'Malware Communication'
        ];
        
        const severityColors = {
            'High': '#ff2b2b',
            'Medium': '#ff9500',
            'Low': '#00e6ff'
        };
        
        for (let i = 0; i < data.anomalies; i++) {
            const anomalyType = anomalyTypes[Math.floor(Math.random() * anomalyTypes.length)];
            const severity = ['High', 'Medium', 'Low'][Math.floor(Math.random() * 3)];
            const packetNum = Math.floor(Math.random() * data.totalPackets);
            
            const item = document.createElement('div');
            item.className = 'anomaly-item';
            item.innerHTML = `
                <div class="anomaly-icon danger" style="background: ${severityColors[severity]}">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div style="flex: 1;">
                    <strong>${anomalyType}</strong>
                    <div style="font-size: 12px; color: #aaa;">
                        Packet #${packetNum} â€¢ ${severity} Severity
                    </div>
                </div>
                <div style="color: ${severityColors[severity]}; font-weight: bold;">
                    ${severity.toUpperCase()}
                </div>
            `;
            anomalyList.appendChild(item);
        }
    }
    
    // Draw all charts
    drawResultsCharts(data);
    
    // Update dashboard stats
    updateDashboardStats();
}

// Draw results charts
function drawResultsCharts(data) {
    // Destroy existing charts
    if (lineChart) lineChart.destroy();
    if (pieChart) pieChart.destroy();
    if (barChart) barChart.destroy();
    if (radarChart) radarChart.destroy();
    
    // 1. Line Chart (Anomaly Score Timeline)
    const lineCtx = document.getElementById('lineGraph').getContext('2d');
    lineChart = new Chart(lineCtx, {
        type: 'line',
        data: {
            labels: data.scores.map((_, i) => `Pkt ${i + 1}`),
            datasets: [{
                label: 'Anomaly Score',
                data: data.scores,
                borderColor: '#00e6ff',
                backgroundColor: 'rgba(0, 230, 255, 0.1)',
                fill: true,
                tension: 0.4,
                pointBackgroundColor: data.scores.map(score => score > 6 ? '#ff2b2b' : '#00e6ff'),
                pointRadius: 5,
                pointHoverRadius: 8
            }]
        },
        options: getChartOptions('Packet Anomaly Scores')
    });
    
    // 2. Pie Chart (Anomaly Distribution)
    const pieCtx = document.getElementById('pieChart').getContext('2d');
    pieChart = new Chart(pieCtx, {
        type: 'pie',
        data: {
            labels: ['Anomalies', 'Normal Packets'],
            datasets: [{
                data: [data.anomalies, 20 - data.anomalies],
                backgroundColor: ['#ff2b2b', '#00e6ff'],
                borderColor: '#fff',
                borderWidth: 2,
                hoverOffset: 15
            }]
        },
        options: getChartOptions('Anomaly Distribution')
    });
    
    // 3. Bar Chart (Severity Levels)
    const barCtx = document.getElementById('barChart').getContext('2d');
    barChart = new Chart(barCtx, {
        type: 'bar',
        data: {
            labels: ['High', 'Medium', 'Low'],
            datasets: [{
                label: 'Severity Count',
                data: [
                    Math.floor(data.anomalies * 0.4),
                    Math.floor(data.anomalies * 0.35),
                    Math.floor(data.anomalies * 0.25)
                ],
                backgroundColor: ['#ff2b2b', '#ff9500', '#00e6ff'],
                borderColor: '#fff',
                borderWidth: 1
            }]
        },
        options: getChartOptions('Anomaly Severity Levels')
    });
    
    // 4. Radar Chart (Protocol Distribution)
    const radarCtx = document.getElementById('radarChart').getContext('2d');
    radarChart = new Chart(radarCtx, {
        type: 'radar',
        data: {
            labels: ['TCP', 'UDP', 'ICMP', 'HTTP', 'DNS', 'HTTPS'],
            datasets: [{
                label: 'Protocol Activity',
                data: [85, 70, 45, 90, 60, 80],
                backgroundColor: 'rgba(0, 230, 255, 0.2)',
                borderColor: '#00e6ff',
                pointBackgroundColor: '#00e6ff',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#00e6ff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: {
                        color: '#fff'
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    titleColor: '#00e6ff',
                    bodyColor: '#fff'
                }
            },
            scales: {
                r: {
                    angleLines: {
                        color: 'rgba(255, 255, 255, 0.1)'
                    },
                    grid: {
                        color: 'rgba(255, 255, 255, 0.1)'
                    },
                    pointLabels: {
                        color: '#aaa'
                    },
                    ticks: {
                        color: '#aaa',
                        backdropColor: 'transparent'
                    }
                }
            }
        }
    });
}

// Export results
function exportResults() {
    showMessage('resultPage', 'Report exported successfully!', 'success');
    // In a real application, this would trigger a file download
    // For demo purposes, we just show a success message
}

// Show message
function showMessage(elementId, text, type) {
    const element = document.getElementById(elementId);
    element.textContent = text;
    element.className = 'message';
    
    switch(type) {
        case 'error':
            element.classList.add('error');
            element.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${text}`;
            break;
        case 'success':
            element.classList.add('success');
            element.innerHTML = `<i class="fas fa-check-circle"></i> ${text}`;
            break;
        case 'info':
            element.classList.add('info');
            element.innerHTML = `<i class="fas fa-info-circle"></i> ${text}`;
            break;
    }
    
    element.classList.remove('hidden');
    
    // Auto-hide success/info messages
    if (type !== 'error') {
        setTimeout(() => {
            element.classList.add('hidden');
        }, 5000);
    }
}

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
    // Escape key goes back to dashboard if logged in
    if (e.key === 'Escape' && currentUser) {
        showPage('dashboard');
    }
    
    // Ctrl+Enter to submit forms
    if (e.ctrlKey && e.key === 'Enter') {
        const activePage = Array.from(document.querySelectorAll('.card'))
            .find(card => !card.classList.contains('hidden'));
        
        if (activePage.id === 'login') login();
        if (activePage.id === 'uploadPage') analyzeFile();
    }
});

// Initialize with first page
showPage('login');
</script>

</body>
</html>
