<script>
function analyzeFile(){
    const file=document.getElementById('pcapFile').files[0];
    const error=document.getElementById('fileError');
    error.classList.add('hidden');

    if(!file){
        error.classList.remove('hidden');
        return;
    }

    // ðŸ‘‰ SHOW RESULTS PAGE FIRST
    showPage('resultPage');

    document.getElementById('resultFileName').innerText=file.name;
    const list=document.getElementById('anomalyList');
    list.innerHTML="";

    let data=[];
    let anomalies=0;
    let normal=0;

    for(let i=1;i<=20;i++){
        let score=Math.floor(Math.random()*10);
        data.push(score);
        if(score>6){
            anomalies++;
            let li=document.createElement('li');
            li.innerHTML="<span class='error'>High anomaly score</span> at packet "+i;
            list.appendChild(li);
        } else {
            normal++;
        }
    }

    if(list.innerHTML==="") list.innerHTML="<li>No anomalies detected</li>";

    // ðŸ‘‰ DRAW CHARTS AFTER PAGE IS VISIBLE
    drawLineGraph(data);
    drawPieChart(anomalies, normal);
}
</script>
